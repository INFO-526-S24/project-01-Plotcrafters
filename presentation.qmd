---
  title: "Revealing UFO Sighting Pattern"
  subtitle: "A Data-Driven Investigation into Global UFO Sightings"
  author: "--Plot Crafters"
  title-slide-attributes:
    data-background-image: images/spaceship-5820448.jpg
    data-background-size: stretch
    data-background-opacity: "0.7"
    data-slide-number: none
  format:
    revealjs:
      theme: League  # Sets the theme of the presentation to "moon"
      transition: convex  # Specifies the transition effect between slides as "convex"
      background-transition: zoom  # Specifies the transition effect for background changes as "zoom"
  editor: visual
  execute:
    echo: false
---

```{r}
#| label: load-packages
#| include: false

# Load packages here
pacman::p_load(tidymodels,
               tidyverse)

```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )
```

```{r}
#| label: load-data
#| include: false
# Load data here
data(mtcars)
mtcars$speed <- mtcars$hp / mtcars$wt

data("penguins")
```

## Introduction

-UFO Sightings Redux" dataset is obtained from National UFO Reporting center. The dataset offers a detailed look into various aspects of UFO sightings, including temporal details, geographical information, and specific characteristics of the reported sightings.Our mission is to decipher patterns, trends, and anomalies within this dataset. By employing data analysis techniques, we aim to uncover temporal, spatial, and thematic insights that may bring us closer to understanding the enigmatic world of UFO sightings.

## Q1: How many UFO sightings have been reported worldwide ? Particular regions where these sightings occur more frequently ?

## Motivation for Question1:

-By exploring the distribution of UFO sightings across different locations, we aim to uncover geographical patterns and hotspots.

-This investigation can provide insights into whether certain areas or countries have a higher incidence of reported UFO sightings, contributing to our understanding of potential regional variations in extraterrestrial encounter reports.

## Global Distribution of UFO Sightings

```{r}
suppressWarnings({
ufo_sightings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-25/ufo_sightings.csv", show_col_types = FALSE)

library(ggplot2)
library(dplyr)

# Read the UFO sightings data
ufo_sightings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-25/ufo_sightings.csv")

# Data Cleaning
ufo_sightings_clean <- ufo_sightings %>%
  filter(!is.na(state))

# Count sightings by country
sightings_by_country <- ufo_sightings_clean %>%
  count(country)

# Read world map data from ggplot2
world_map <- map_data("world")

# Merge with sightings data
world_map_with_sightings <- left_join(world_map, sightings_by_country, by = c("region" = "country"))

# Create Choropleth Map with individual sightings as points
choropleth_map <- ggplot() +
  geom_polygon(data = world_map_with_sightings, aes(x = long, y = lat, group = group, fill = n), color = "black") +
  geom_point(data = ufo_sightings_clean, aes(x = longitude, y = latitude), color = "red", alpha = 0.3) +
  labs(title = "Global Distribution of UFOs",
       subtitle = "Choropleth Map with Individual Sightings",
       x = "Longitude",
       y = "Latitude",
       fill = "Number of Sightings") +  # Add legend title
  theme_minimal() +  # Use minimal theme
  theme(plot.title = element_text(size = 20, face = "bold"),  # Adjust title font size and style
        plot.subtitle = element_text(size = 14, color = "gray"),  # Adjust subtitle font size and color
        axis.title.x = element_text(size = 12),  # Adjust x-axis title size
        axis.title.y = element_text(size = 12),  # Adjust y-axis title size
        legend.title = element_text(size = 12),  # Adjust legend title size
        legend.text = element_text(size = 10)) +  # Adjust legend text size
  scale_fill_gradient(name = "Number of Sightings", low = "#FFEDA0", high = "#F44336")  # Adjust color gradient

world_map <- map_data("world")

# Create Heatmap with map outline
heatmap_with_map <- ggplot() +
  geom_polygon(data = world_map, aes(x = long, y = lat, group = group), color = "black", fill = NA) +  # Map outline
  geom_bin2d(data = ufo_sightings_clean, aes(x = longitude, y = latitude), bins = 50, color = "black") +  # Heatmap
  scale_fill_gradient(name = "Frequency", low = "#045275", high = "#D32F2F") +  # Color gradient
  labs(title = "Heatmap of UFO Sightings", 
       subtitle = "Heatmap Showing Frequency of Sightings",
       x = "Longitude", y = "Latitude") +  # Axis labels
  theme_minimal() +  # Minimal theme
  theme(plot.title = element_text(size = 20, face = "bold"),  # Title font size and style
        plot.subtitle = element_text(size = 14, color = "gray"),  # Subtitle font size and color
        axis.text = element_text(size = 10),  # Axis text size
        legend.title = element_text(size = 12),  # Legend title size
        legend.text = element_text(size = 10))  # Legend text size


# Print the choropleth map
print(choropleth_map)


})
```

## Frequency of Sightings

```{r}
# Print the heatmap with map outline
print(heatmap_with_map)
```

## Inferences Drawn from the Plots

-   The total number of UFOs sighted globally is 74,345

-   UFO are sighted more frequently in North America

## Q2: Is there any specific time of the day when UFO sighting are more prevalent?

## Motivation for Question2:

-   By exploring temporal patterns in UFO sightings, we aim to identify if certain times of the day are associated with a higher frequency of reported encounters.
-   This investigation can provide valuable insights into the temporal aspects of UFO sightings, potentially revealing patterns that could be linked to environmental conditions, human behavior, or other factors.

## Understanding Time Trend for UFO sightings

```{r}
suppressWarnings({
library(ggplot2)
library(png)
library(tidyverse)
library(lubridate)
library(viridis)
library(png)
library(cowplot)

# Read the data
ufo_sightings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-25/ufo_sightings.csv", show_col_types = FALSE)

# Convert character strings of date_time variable into POSIXct format
ufo_sightings$date_time <- as.POSIXct(ufo_sightings$date_time, format = "%m/%d/%Y %H:%M")

# Extract the hour component
ufo_sightings$hour_of_day <- hour(ufo_sightings$date_time)

# Create a summary table for counts of sightings per hour
hourly_counts <- table(ufo_sightings$hour_of_day)

# Convert the summary table to a data frame
hourly_counts_df <- data.frame(hour = as.numeric(names(hourly_counts)), count = as.numeric(hourly_counts))

# Plotting with polar coordinates
bar_plot_polar <- ggplot(hourly_counts_df, aes(x = factor(hour), y = count)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  scale_x_discrete(name = "Hour of Day") +
  scale_y_continuous(name = NULL) +
  labs(title = "UFO Sightings by Hour of Day") +
  theme_minimal() +
  theme(axis.text.y = element_blank(),
        axis.line.y = element_blank(),
        axis.ticks = element_blank(), 
        panel.grid.major.y = element_blank()) +
  coord_polar(start = -pi/1.45)

# Read the image
img <- readPNG("images/q2Clock.png")
ger <- grid::rasterGrob(img, interpolate=TRUE)

# Draw the plot
coord_plot <- ggdraw(bar_plot_polar)

# Combine the plot and the image
coord_plot + draw_grob(ger, 0.168, 0.18, 0.65, 0.65) + 
  draw_plot(bar_plot_polar)

})
```

## Inference drawn from the plot

1.  Optimal Visibility: Darker evening skies provide better visibility, aiding in the detection of unusual objects or lights.

2.  Leisure Activities: Evening leisure pursuits, like stargazing and outdoor activities, increase opportunities for people to spot UFOs while relaxing outdoors.

3.  Cultural Influence: Cultural depictions of UFO sightings during nighttime and psychological factors may heighten vigilance and reporting of sightings during evening hours.

## Count of UFO by different Time of Day

```{r}
suppressWarnings({
# Load necessary libraries
library(tidyverse)

#> Loading the Dataset 

#> UFO_Sightings

ufo_sightings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-25/ufo_sightings.csv", show_col_types = FALSE)

#> Data Wrangling

#> Exploring the data interactively
#View(ufo_sightings)

#Displaying first few entries of date_time column
#head(ufo_sightings$date_time)

#Displaying the data type of the date_time column
#class(ufo_sightings$date_time)

#> Finding Missing Data in date_time
#sum(is.na(ufo_sightings$date_time))

# Load the lubridate package
library(lubridate)


# converting character strings of date_time variable into a format that R can recognize and manipulate as date-time data.
ufo_sightings$date_time <- as.POSIXct(ufo_sightings$date_time, format = "%m/%d/%Y %H:%M")

# Extracting the hour component
hour_of_day <- hour(ufo_sightings$date_time)

# Define time ranges for each bin
morning_hours <- 6:11
afternoon_hours <- 12:17
evening_hours <- 18:21
night_hours <- c(22:23, 0:5)

# Function to assign time bins
assign_time_bin <- function(hour_of_day) {
  if (hour_of_day %in% morning_hours) {
    return("Morning")
  } else if (hour_of_day %in% afternoon_hours) {
    return("Afternoon")
  } else if (hour_of_day %in% evening_hours) {
    return("Evening")
  } else {
    return("Night")
  }
}

# Create a new variable representing the time of day bins
ufo_sightings$time_of_day <- sapply(hour_of_day, assign_time_bin)

# Output the time_of_day variable
#ufo_sightings$time_of_day

# Displaying date_time and time_of_day variables of ufo_sightings dataframe side by side
# View(ufo_sightings[, c("date_time", "time_of_day")])

# Write the dataframe to a CSV file
#write.csv(ufo_sightings, "ufo_sightings_with_time_of_day.csv", row.names = FALSE)

#finding out the current working directory in R to get the ufo_sightings_with_time_of_day.csv dataframe
#getwd()

library(ggplot2)
library(dplyr)

# Read the CSV file and prepare the data
ufo_data <- read.csv("ufo_sightings_with_time_of_day.csv")

# Convert time_of_day to a factor with specified order
ufo_data$time_of_day <- factor(ufo_data$time_of_day, levels = c("Morning", "Afternoon", "Evening", "Night"))

# Group the data by time_of_day and summarize to calculate count of sightings
ufo_summary <- ufo_data %>%
  group_by(time_of_day) %>%
  summarize(count = n())

# Create the plot
ggplot(ufo_summary, aes(x = time_of_day, y = count, fill = count)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "lightblue", high = "darkblue") +  # Use a gradient scale from light blue to dark blue
  geom_text(aes(label = count), vjust = -0.5, color = "black") +
  theme_minimal() +
  labs(title = "UFO Sightings Count by Time of Day",
       x = "Time of Day",
       y = "Count") +
  theme(plot.background = element_rect(fill = "transparent", color = NA),
        panel.background = element_rect(fill = "transparent", color = NA),
        panel.grid.major = element_line(color = "gray", size = 0.5),  # Add major grid lines
        panel.grid.minor = element_blank(),
        axis.line = element_line(color = "black"),
        axis.text = element_text(color = "black"),
        axis.title = element_text(color = "black"),
        plot.title = element_text(hjust = 0.5, size = 20, color = "black"))

})
```

## Observations for Q2

-   Nighttime records the highest UFO sightings, with 34,283 occurrences, followed closely by Evening with 30,211 sightings.

-   In contrast, Morning and Afternoon show considerably lower counts of 6,200 and 9,638 sightings, respectively.

# Wrap up

## Overall Conclusion for both Q1 & Q2

-   Americans by far claimed ufo sightings most frequently. Three possible conclusions:

    1\) alien UFOs have unfinished business in the USA

    2\) Americans are the most delusional

    3\) Other countries don't care to collect such data so UFO sightings would be under-reported.

-   UFO sightings tend to be more prevalent during the night, aligning with the common perception of UFO sightings occurring in the dark.

## Thank you {style="text-align: center"}

![](images/neuralyzer-men-in-black.gif){fig-align="center"}
